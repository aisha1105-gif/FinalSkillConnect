<!DOCTYPE html>
<html lang="en">
<html xmlns:th="https://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/jpeg" href="/images/SkillConnect-favicon.jpeg">
    <link rel="stylesheet" th:href="@{/css/stylesheet.css}" />
    <title>Freelancer Sign Up</title>
</head>
<body>
    <header class="header">
        <div class="header-content">
            <a href="home">
                <img
                     src="/images/SkillConnect-favicon.jpeg"
                     alt="SkillConnect"
                     title="SkillConnect"
                     /> 
            </a>
            <h1 class="logo">SkillConnect: Revolutionizing the Way You Work</h1>
            <nav class="nav">
                <a href="home">Home</a>
                <a href="aboutUs">About Us</a>
            </nav>
        </div>
    </header>
    
    <main>
    <h1>Freelancer: Sign Up</h1>
    <form th:action="@{freelancer-signup}" method="POST" th:object="${freelancer}">
        <div>
            <label for="fname">First Name:</label>
            <input type="text" id="fname" th:field="*{first_name}" placeholder="Enter your first name" required />
            <span th:if="${#fields.hasErrors('first_name')}" th:classappend="'error'" th:errors="*{first_name}">fname Error</span>
        </div>

        <div>
            <label for="lname">Last Name</label>
            <input type="text" id="lname" th:field="*{last_name}" placeholder="Enter your last name" required />
            <span th:if="${#fields.hasErrors('last_name')}" th:classappend="'error" th:errors="*{last_name}">lname Error</span>
        </div>

        <div>
            <label for="email">Email:</label>
            <input type="email" id="email" th:field="*{email}" placeholder="Enter your email" required />
            <span th:if="${#fields.hasErrors('email')}" th:classappend="'error'" th:errors="*{email}">Email Error</span>
        </div>

        <div>
            <label for="password">Password:</label>
            <input type="password" id="password" th:field="*{password}" placeholder="Enter your password" required />
            <span th:if="${#fields.hasErrors('password')}" th:classappend="'error'" th:errors="*{password}">Password Error</span>
        </div>

        <!-- Display Error if Freelancer with same email already exists -->
        <div th:if="${error}">
            <p style="color: red;">[[${error}]]</p>
        </div>

        <h3>Select your skills and set prices</h3>

        <div th:each="skill : ${skillsList}" style="margin-bottom: 10px;">
            <input type="checkbox" 
                   th:id="'skill-' + ${skill.id}" 
                   th:name="skillIds" 
                   th:value="${skill.id}" 
                   onchange="togglePriceInput(this)" />
        
            <label th:for="'skill-' + ${skill.id}" 
                   th:text="${skill.name}"></label>
        
            <input type="number" step="0.01" min="50"
                   th:name="'prices[' + ${skill.id} + ']'"
                   th:id="'price-for-skill-' + ${skill.id}"
                   placeholder="Enter your price"
                   style="display:none; margin-left: 10px;" />
        </div>
        
        
        <script>
            function togglePriceInput(checkbox) {
                const skillId = checkbox.value;
                const priceInput = document.getElementById('price-for-skill-' + skillId);
                if (checkbox.checked) {
                    priceInput.style.display = 'inline-block';
                    priceInput.required = true;  // optional: require price when checked
                } else {
                    priceInput.style.display = 'none';
                    priceInput.required = false;
                    priceInput.value = ''; // clear input when unchecked
                }
            }
        </script>
        
        <div class="button-container">
            <button type="submit"  class="btn-primary">Sign Up</button>
        </div>
    </form>
    </main>
</body>
</html>